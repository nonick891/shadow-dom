!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.shadowDom=e():t.shadowDom=e()}(self,(()=>(()=>{"use strict";var t={d:(e,s)=>{for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>j});const s=t=>t instanceof Node,r=t=>t instanceof Node,o=(t,e)=>n(i(a(t)),e),n=(t,e)=>{return!(!r(s=e)&&!(t=>t.constructor&&"ShadowRoot"===t.constructor.name)(s)||!r(t))&&e.appendChild(t);var s},i=t=>c(h(t),t),h=t=>{let e=l(t.tagName);return t.child&&t.child.map((t=>o(t,e))),e},l=t=>document.createElement(t),a=t=>t&&t.tagName?t:d(t),d=t=>Object.assign(u(),Boolean(t)?t:{}),u=()=>({tagName:"div"}),c=(t,e)=>(p(t,e),m(e),f(e,t),t),p=(t,{html:e})=>!!e&&(t.innerHTML=e),m=t=>["tagName","html","child","dom-link"].map((e=>delete t[e])),f=(t,e)=>Object.keys(t).map((s=>e.setAttribute(s,t[s]))),y=t=>r(t)&&t.remove(),b=t=>Array.isArray(t)&&t.map(y),g=t=>e=>e.matches(t)||e.querySelector(t),I=(t,e)=>!!(t&&t instanceof HTMLElement)&&t.querySelector(e),O=(t,e)=>r(t)?t:(t=>document.body.querySelector(t))("string"==typeof t?t:e),S=o,v=b;class j{el=null;root=null;inserts=[];rootInsert=null;constructor(t){if(this.setParams(t),!this.el)return!1;this.el.shadowRoot||this.el.attachShadow({mode:"open"}),this.root=this.el.shadowRoot,this.rootInsert=this.root}setParams(t){this.el=null,this.opts={selector:".shadow-rooted"},s(t)?this.setElement(t):this.setOptions(t).setElement()}setOptions(t){return"string"==typeof t?this.setOption("selector",t):Object.keys(t).map((e=>this.setOption(e,t[e]))),this}setOption(t,e){this.opts[t]=void 0!==e?e:this.opts[t]}setElement(t){let e=O(t,this.opts.selector);var s;this.el=e&&"IFRAME"===e.tagName?(s=e,s.contentDocument||s.contentWindow.document).body:e}insertAll(t,e){return t.map((t=>this.insert(t,e))),this}insert(t,e){return this.pushInsert(this.getInsert(t,e)),this}pushInsert(t){this.inserts.push(t)}getInsert(t,e){return S(t,this.getCurrentElement(e))}bringInserts(){let t=[...this.inserts];return this.inserts=[],t}append(t,e){this.find(t).appendChild(e)}find(t){return((t,e)=>{let s=t.find(g(e));return I(s,e)||s})(this.inserts,t)}select(t){return((t,e)=>t.filter(g(e)).map((t=>I(t,e)||t)))(this.inserts,t)}closest(t){return this.root.host.closest(t)}getCurrentElement(t){return this.setInsert(t).queryInsertRoot()}setInsert(t){return this.rootInsert=t?"ShadowRoot"!==t?t:this.root:this.rootInsert,this}queryInsertRoot(){return s(this.rootInsert)?this.rootInsert:(t=this.root,e=this.rootInsert,t&&e&&!t.isSameNode(e)?t.querySelector(e):t);var t,e}clear(){return v(this.inserts),this.inserts=[],(t=this.root).hasChildNodes()&&b(t.childNodes),!0;var t}}return e})()));